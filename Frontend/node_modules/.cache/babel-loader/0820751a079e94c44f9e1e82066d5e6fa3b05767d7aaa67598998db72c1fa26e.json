{"ast":null,"code":"import _regeneratorRuntime from\"c:/Users/hp/Desktop/AI3/meeting-schedule-app/Frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"c:/Users/hp/Desktop/AI3/meeting-schedule-app/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"c:/Users/hp/Desktop/AI3/meeting-schedule-app/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"c:/Users/hp/Desktop/AI3/meeting-schedule-app/Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{useForm}from\"react-hook-form\";import{useNavigate}from\"react-router-dom\";import meetingsService from\"../../../Services/MeetingsService\";import\"./AddMeeting.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AddMeeting(){var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),teams=_useState2[0],setTeams=_useState2[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue;// دالة لتحويل تاريخ API إلى صيغة مناسبة لحقل datetime-local\nfunction formatDateForInput(dateString){var date=new Date(dateString);return date.toISOString().slice(0,16);}useEffect(function(){meetingsService.getAllTeams().then(function(teams){return setTeams(teams);}).catch(function(err){return alert(\"Failed to load teams: \"+err.message);});},[]);function send(_x){return _send.apply(this,arguments);}function _send(){_send=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(meeting){var _err$response,_err$response$data,suggestion,end;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(new Date(meeting.startTime).getTime()>new Date(meeting.endTime).getTime())){_context.next=3;break;}alert(\"End time cannot be before start time.\");return _context.abrupt(\"return\");case 3:_context.prev=3;_context.next=6;return meetingsService.addMeeting(meeting);case 6:alert(\"Meeting has been added successfully.\");navigate(\"/list\");_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);// تحقق من وجود حالة تعارض\nif(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===409&&(_err$response$data=_context.t0.response.data)!==null&&_err$response$data!==void 0&&_err$response$data.suggestion){suggestion=_context.t0.response.data.suggestion;alert(\"Conflict detected! Suggested Time: \".concat(suggestion.time,\", Room: \").concat(suggestion.room));// تعبئة الفورم بالقيم المقترحة\nsetValue(\"startTime\",formatDateForInput(suggestion.time));// لو عندك endTime في الاقتراح استخدمه، وإلا خلي مدة الاجتماع ساعة مثلاً\nif(suggestion.endTime){setValue(\"endTime\",formatDateForInput(suggestion.endTime));}else{// افتراضياً أضف ساعة على الوقت المقترح\nend=new Date(suggestion.time);end.setHours(end.getHours()+1);setValue(\"endTime\",end.toISOString().slice(0,16));}setValue(\"room\",suggestion.room);// لو حابب تعيد اختيار الفريق مثلاً:\nif(suggestion.teamId)setValue(\"teamId\",suggestion.teamId);}else{alert(\"Failed to add meeting: \"+(_context.t0.message||_context.t0));}case 13:case\"end\":return _context.stop();}}},_callee,null,[[3,10]]);}));return _send.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"AddMeeting\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add Meeting\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(send),children:[/*#__PURE__*/_jsx(\"label\",{children:\"Select Team:\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({defaultValue:\"\"},register(\"teamId\")),{},{required:true,children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",children:\"-- Select Team --\"}),teams.map(function(t){return/*#__PURE__*/_jsx(\"option\",{value:t.id,children:t.name},t.id);})]})),/*#__PURE__*/_jsx(\"label\",{children:\"Start of Meeting:\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"datetime-local\"},register(\"startTime\")),{},{required:true})),/*#__PURE__*/_jsx(\"label\",{children:\"End of Meeting:\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"datetime-local\"},register(\"endTime\")),{},{required:true})),/*#__PURE__*/_jsx(\"label\",{children:\"Description:\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\"},register(\"description\")),{},{required:true,minLength:1,maxLength:100})),/*#__PURE__*/_jsx(\"label\",{children:\"Meeting Room:\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\"},register(\"room\")),{},{required:true,minLength:1,maxLength:100})),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Add\"})]})]});}export default AddMeeting;","map":{"version":3,"names":["useEffect","useState","useForm","useNavigate","meetingsService","AddMeeting","navigate","teams","setTeams","register","handleSubmit","setValue","formatDateForInput","dateString","date","Date","toISOString","slice","getAllTeams","then","catch","err","alert","message","send","meeting","startTime","getTime","endTime","addMeeting","response","status","data","suggestion","time","room","end","setHours","getHours","teamId","map","t","id","name"],"sources":["c:/Users/hp/Desktop/AI3/meeting-schedule-app/Frontend/src/Components/DataArea/Insert/AddMeeting.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport MeetingModel from \"../../../Models/MeetingModel\";\r\nimport TeamModel from \"../../../Models/TeamModel\";\r\nimport meetingsService from \"../../../Services/MeetingsService\";\r\n\r\nimport \"./AddMeeting.css\";\r\n\r\nfunction AddMeeting(): JSX.Element {\r\n\r\n    const navigate = useNavigate();\r\n    const [teams, setTeams] = useState<TeamModel[]>([]);\r\n    const { register, handleSubmit, setValue } = useForm<MeetingModel>();\r\n\r\n    // دالة لتحويل تاريخ API إلى صيغة مناسبة لحقل datetime-local\r\n    function formatDateForInput(dateString: string): string {\r\n        const date = new Date(dateString);\r\n        return date.toISOString().slice(0,16);\r\n    }\r\n\r\n    useEffect(() => {\r\n        meetingsService.getAllTeams()\r\n            .then(teams => setTeams(teams))\r\n            .catch(err => alert(\"Failed to load teams: \" + err.message));\r\n    }, []);\r\n\r\n    async function send(meeting: MeetingModel) {\r\n        if (new Date(meeting.startTime).getTime() > new Date(meeting.endTime).getTime()) {\r\n            alert(\"End time cannot be before start time.\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await meetingsService.addMeeting(meeting);\r\n            alert(\"Meeting has been added successfully.\");\r\n            navigate(\"/list\");\r\n        }\r\n        catch (err: any) {\r\n            // تحقق من وجود حالة تعارض\r\n            if (err.response?.status === 409 && err.response.data?.suggestion) {\r\n                const suggestion = err.response.data.suggestion;\r\n                alert(`Conflict detected! Suggested Time: ${suggestion.time}, Room: ${suggestion.room}`);\r\n\r\n                // تعبئة الفورم بالقيم المقترحة\r\n                setValue(\"startTime\", formatDateForInput(suggestion.time));\r\n                // لو عندك endTime في الاقتراح استخدمه، وإلا خلي مدة الاجتماع ساعة مثلاً\r\n                if (suggestion.endTime) {\r\n                    setValue(\"endTime\", formatDateForInput(suggestion.endTime));\r\n                } else {\r\n                    // افتراضياً أضف ساعة على الوقت المقترح\r\n                    const end = new Date(suggestion.time);\r\n                    end.setHours(end.getHours() + 1);\r\n                    setValue(\"endTime\", end.toISOString().slice(0,16));\r\n                }\r\n                setValue(\"room\", suggestion.room);\r\n                // لو حابب تعيد اختيار الفريق مثلاً:\r\n                if (suggestion.teamId) setValue(\"teamId\", suggestion.teamId);\r\n            }\r\n            else {\r\n                alert(\"Failed to add meeting: \" + (err.message || err));\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"AddMeeting\">\r\n            <h2>Add Meeting</h2>\r\n\r\n            <form onSubmit={handleSubmit(send)}>\r\n\r\n                <label>Select Team:</label>\r\n                <select defaultValue=\"\" {...register(\"teamId\")} required>\r\n                    <option disabled value=\"\">-- Select Team --</option>\r\n                    {teams.map(t => (\r\n                        <option key={t.id} value={t.id}>{t.name}</option>\r\n                    ))}\r\n                </select>\r\n\r\n                <label>Start of Meeting:</label>\r\n                <input type=\"datetime-local\" {...register(\"startTime\")} required />\r\n\r\n                <label>End of Meeting:</label>\r\n                <input type=\"datetime-local\" {...register(\"endTime\")} required />\r\n\r\n                <label>Description:</label>\r\n                <input type=\"text\" {...register(\"description\")} required minLength={1} maxLength={100} />\r\n\r\n                <label>Meeting Room:</label>\r\n                <input type=\"text\" {...register(\"room\")} required minLength={1} maxLength={100} />\r\n\r\n                <button type=\"submit\">Add</button>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AddMeeting;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}